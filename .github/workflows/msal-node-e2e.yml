# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: msal-node E2E Tests

on:
  pull_request:
    paths:
      - '.github/workflows/msal-node-e2e.yml'
  merge_group:
    types: [checks_requested]

concurrency:
  group: node-e2e-${{github.ref}}
  cancel-in-progress: true

permissions:
  contents: read
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: 'Az CLI login'
        uses: azure/login@v1
        with:
          client-id: ${{ secrets.TEST_CLIENT_ID }}
          tenant-id: ${{ secrets.TEST_TENANT_ID }}
          allow-no-subscriptions: true
  
      - name: 'Run az commands'
        run: az keyvault secret show --name ${{ secrets.TEST_SECRET_NAME }} --vault-name ${{ secrets.TEST_VAULT_NAME }}